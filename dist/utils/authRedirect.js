"use strict";Object.defineProperty(exports,Symbol.toStringTag,{value:"Module"});const n="aiworkspace.pro";function g(o){return o==="localhost"||/^\d+\.\d+\.\d+\.\d+$/.test(o)}function S(o){return o===n||o.endsWith(`.${n}`)}function r(o){return document.cookie.split(";").map(c=>c.trim()).filter(c=>o.some(t=>c.startsWith(t+"=")))}function d(o,e,s=60*60*24*365){const c=location.hostname;if(g(c)){document.cookie=`${o}=${encodeURIComponent(e)}; Path=/; Max-Age=${s}; SameSite=Lax`,console.log("[auth][cookie][set][local]",{host:c,name:o,valuePreview:e.slice(0,20)+"..."}),console.log("[auth][cookie][after]",r([o]));return}document.cookie=`${o}=${encodeURIComponent(e)}; Domain=.${n}; Path=/; Max-Age=${s}; SameSite=Lax; Secure`,document.cookie=`${o}=; Path=/; Max-Age=0; SameSite=Lax`,console.log("[auth][cookie][set][apex]",{host:c,apex:n,name:o,valuePreview:e.slice(0,20)+"..."}),console.log("[auth][cookie][after]",r([o]))}function l(o){const e=new RegExp("(?:^|; )"+o.replace(/[$()*+.[\]?^{}|\\/-]/g,"\\$&")+"=([^;]*)"),s=document.cookie.match(e);return s?decodeURIComponent(s[1]):null}function L(o){const e=location.hostname;if(g(e)){document.cookie=`${o}=; Path=/; Max-Age=0; SameSite=Lax`,console.log("[auth][cookie][clear][local]",{host:e,name:o});return}document.cookie=`${o}=; Domain=.${n}; Path=/; Max-Age=0; SameSite=Lax; Secure`,document.cookie=`${o}=; Path=/; Max-Age=0; SameSite=Lax`,console.log("[auth][cookie][clear][apex]",{host:e,apex:n,name:o}),console.log("[auth][cookie][after]",r([o]))}function p(o){const e=location.hostname;if(g(e)){console.log("[auth][cookie][promote] skip (local host)",e);return}if(!S(e)){console.log("[auth][cookie][promote] skip (not under apex)",{host:e,apex:n});return}console.log("[auth][cookie][promote] start",{host:e,apex:n,names:o}),o.forEach(s=>{const c=l(s);c?d(s,c,60*60*24*365):console.log("[auth][cookie][promote] missing",s)}),console.log("[auth][cookie][promote] done",r(o))}function E(){return`${window.location.origin}/auth/callback`}function k(){try{const o=new URLSearchParams(location.search),e=new URLSearchParams(location.hash.replace("#","")),s=["redirect","redirect_to","returnTo","next","redirect_origin"].find(a=>o.get(a)),c=["redirect","redirect_to","returnTo","next","redirect_origin"].find(a=>e.get(a));let t=s?o.get(s):c?e.get(c):"";if(console.log("[getPostLoginBase] Search params:",Object.fromEntries(o)),console.log("[getPostLoginBase] Hash params:",Object.fromEntries(e)),console.log("[getPostLoginBase] Found search param key:",s),console.log("[getPostLoginBase] Found hash param key:",c),console.log("[getPostLoginBase] Candidate from params:",t),!t){const a=sessionStorage.getItem("post-login-redirect")||localStorage.getItem("post-login-redirect")||"";if(console.log("[getPostLoginBase] Stored URL from storage:",a),a.startsWith("http"))try{const i=new URL(a);t=i.pathname+i.search+i.hash,console.log("[getPostLoginBase] Extracted path from stored URL:",t)}catch(i){console.log("[getPostLoginBase] Error parsing stored URL:",i),t=a}else t=a;console.log("[getPostLoginBase] Final candidate from storage:",t)}if(t||(t={VITE_SUPABASE_URL:"https://oqdnbpmmgntqtigstaow.supabase.co",VITE_SUPABASE_ANON_KEY:"eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJpc3MiOiJzdXBhYmFzZSIsInJlZiI6Im9xZG5icG1tZ250cXRpZ3N0YW93Iiwicm9sZSI6ImFub24iLCJpYXQiOjE3MzQ0NTk2NDYsImV4cCI6MjA1MDAzNTY0Nn0.rn0nRY9xLgLt-ajiSPeG0PcdS9V-549C1yeqhcxxG40",VITE_APEX_DOMAIN:"aiworkspace.pro",BASE_URL:"/",MODE:"production",DEV:!1,PROD:!0,SSR:!1}.VITE_DEFAULT_POST_LOGIN_URL||"/",console.log("[getPostLoginBase] Using default:",t)),t.startsWith("http"))try{const a=new URL(t);return S(a.hostname)||g(a.hostname)?(console.log("[getPostLoginBase] Returning absolute URL:",t),t):(console.log("[getPostLoginBase] Invalid hostname, returning /"),"/")}catch{return console.log("[getPostLoginBase] Invalid URL, returning /"),"/"}return t.startsWith("/")||(t="/"+t),console.log("[getPostLoginBase] Final candidate:",t),t}catch(o){return console.log("[getPostLoginBase] Error:",o),"/"}}const m="sb-access-token",I="sb-refresh-token",u="sb-access-token",h="sb-refresh-token";function f(){try{const o=l(m),e=l(I);o&&localStorage.setItem(u,o),e&&localStorage.setItem(h,e),console.log("[auth][cookie->ls] sync",{hasAccess:!!o,hasRefresh:!!e})}catch(o){console.log("[auth][cookie->ls] error",o)}}function P(){try{localStorage.removeItem(u),localStorage.removeItem(h),console.log("[auth][cookie->ls] cleared localStorage")}catch(o){console.log("[auth][cookie->ls] clear error",o)}}exports.ACCESS_COOKIE=m;exports.LS_ACCESS_KEY=u;exports.LS_REFRESH_KEY=h;exports.REFRESH_COOKIE=I;exports.buildOAuthRedirectUrl=E;exports.clearLocalStorageTokens=P;exports.clearSessionCookie=L;exports.ensureCrossSubdomainCookies=p;exports.getCookie=l;exports.getPostLoginBase=k;exports.setSessionCookie=d;exports.syncCookiesToLocalStorage=f;
